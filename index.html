<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Academia Espacial: Física Interactiva v13</title>
    
    <!-- 🎨 LIBRERÍAS EXTERNAS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@400;600&family=Exo+2:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <!-- 📁 ARCHIVOS LOCALES -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- 🚀 CONTENEDOR PRINCIPAL DEL JUEGO -->
    <div class="game-wrapper" id="gameWrapper">
        
        <!-- 📊 BARRA SUPERIOR - ESTADÍSTICAS -->
        <div class="stats-bar">
            <div class="stat"><span>Nivel:</span><span id="level" class="font-bold">1</span></div>
            <div class="stat"><span>Vidas:</span><div class="lives-container" id="livesContainer"></div></div>
            <div class="stat"><span>Puntos:</span><span id="score" class="font-bold">0</span></div>
            <div class="stat">
                <span>Progreso:</span>
                <span id="progress" class="font-bold">0/10</span>
                <div class="progress-bar w-16 md:w-20"><div id="progressFill" class="progress-fill"></div></div>
            </div>
            <div class="stat"><span>Nota:</span><span id="grade" class="font-bold">0.0</span><span class="text-yellow-400">⭐</span></div>
            <div class="stat"><span>Tema:</span><span id="currentTopic" class="font-bold">Magnitudes</span></div>
        </div>

        <!-- 🎮 CANVAS DEL JUEGO -->
        <canvas id="gameCanvas"></canvas>

        <!-- 🎛️ PANEL DE CONTROLES -->
        <div class="controls-container">
            <div class="control-group" style="width: 100%;">
                <label class="font-bold text-sm text-center w-full mb-2">SELECCIONAR TEMAS DE FÍSICA</label>
                <div class="topic-switcher">
                    <input type="checkbox" id="topicMagnitudes" name="gameTopics" value="magnitudes" checked>
                    <label for="topicMagnitudes">Magnitudes</label>
                    
                    <input type="checkbox" id="topicSI" name="gameTopics" value="si">
                    <label for="topicSI">Sistema SI</label>
                    
                    <input type="checkbox" id="topicCinematica" name="gameTopics" value="cinematica">
                    <label for="topicCinematica">Cinemática</label>
                    
                    <input type="checkbox" id="topicMRU" name="gameTopics" value="mru">
                    <label for="topicMRU">MRU</label>
                    
                    <input type="checkbox" id="topicMRUA" name="gameTopics" value="mrua">
                    <label for="topicMRUA">MRUA</label>
                    
                    <input type="checkbox" id="topicMCU" name="gameTopics" value="mcu">
                    <label for="topicMCU">MCU</label>
                    
                    <input type="checkbox" id="topicGravedad" name="gameTopics" value="gravedad">
                    <label for="topicGravedad">Mov. Vertical</label>
                    
                    <input type="checkbox" id="topicParabolico" name="gameTopics" value="parabolico">
                    <label for="topicParabolico">Mov. Parabólico</label>
                </div>
            </div>
            
            <div class="flex flex-wrap gap-3 md:gap-4 items-center justify-center w-full">
                <div class="control-group">
                    <label for="levelSelect" class="font-bold">Nivel:</label>
                    <select id="levelSelect" class="bg-gray-800 text-white border border-cyan-400 rounded px-2 py-1 md:px-3 md:py-2">
                        <option value="1">1 (10)</option>
                        <option value="2">2 (20)</option>
                        <option value="3">3 (30)</option>
                    </select>
                </div>
                
                <button id="startButton" class="game-button btn-success">
                    <span class="btn-icon">🚀</span>
                    <span id="startButtonText" class="btn-text">Lanzar</span>
                </button>
                
                <button id="pauseButton" class="game-button btn-warning" disabled>
                    <span class="btn-icon">⏸️</span>
                    <span class="btn-text">Pausa</span>
                </button>
                
                <button id="soundButton" class="game-button">
                    <span class="btn-icon">🔊</span>
                    <span class="btn-text">Sonido</span>
                </button>
                
                <button id="helpButton" class="game-button">
                    <span class="btn-icon">❓</span>
                    <span class="btn-text">Ayuda</span>
                </button>
                
                <button id="resetButton" class="game-button">
                    <span class="btn-icon">🔄</span>
                    <span class="btn-text">Reiniciar</span>
                </button>
            </div>
        </div>
        
        <!-- 👨‍🚀 PIE DE PÁGINA -->
        <footer class="galactic-footer">
            <div id="footer-author" class="footer-author">Autor: Msc Néstor Fabio Montoya Palacios</div>
            <div id="footer-ship">🛸</div>
        </footer>
    </div>
    
    <!-- 🪟 MODALES DEL JUEGO -->
    
    <!-- Modal de Preguntas -->
    <div id="questionModal" class="modal">
        <div class="modal-content">
            <h2 class="!text-xl md:!text-2xl">🎯 Desafío de Física</h2>
            <div id="questionData" class="mb-4 p-3 bg-gray-800 rounded text-xs md:text-sm"></div>
            <div id="questionText" class="text-base md:text-lg mb-6 leading-relaxed"></div>
            <div id="optionsContainer" class="space-y-3"></div>
            <button id="answerButton" class="game-button btn-success mt-6" disabled>✅ Confirmar</button>
        </div>
    </div>
    
    <!-- Modal de Feedback -->
    <div id="feedbackModal" class="modal">
        <div class="modal-content">
            <h2 id="feedbackTitle"></h2>
            <p id="feedbackText" class="text-lg mb-4"></p>
            <div id="solution-container" style="display: none;"></div>
            <button id="nextButton" class="game-button btn-success mt-6">▶️ Continuar</button>
        </div>
    </div>
    
    <!-- Modal de Ayuda -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <h2>📚 Manual del Cadete</h2>
            <div class="text-left space-y-4 text-sm">
                <h3 class="text-cyan-400 font-bold text-lg mb-2">🎯 Misión</h3>
                <p>Pilota tu nave 🚀 y colisiona con meteoritos ☄️. ¡Responde preguntas de física para dominar el universo!</p>
                
                <h3 class="text-cyan-400 font-bold text-lg mb-2">🎮 Controles</h3>
                <ul class="list-disc list-inside space-y-1 ml-4">
                    <li><strong>Mouse/Dedo:</strong> Mueve la nave</li>
                    <li><strong>Colisiones:</strong> Toca meteoritos para aprender</li>
                    <li><strong>Temas:</strong> Elige uno o varios temas</li>
                    <li><strong>Sonido:</strong> Activa/desactiva con 🔊</li>
                </ul>
            </div>
            <button id="closeHelp" class="game-button mt-6">🚀 ¡Entendido!</button>
        </div>
    </div>
    
    <!-- Modal de Subida de Nivel -->
    <div id="levelUpModal" class="modal">
        <div class="modal-content">
            <h2 id="levelUpTitle" class="text-2xl"></h2>
            <p id="levelUpText" class="text-lg mb-6"></p>
            <div id="levelUpStats" class="mb-6 p-4 bg-gray-800 rounded"></div>
            <button id="nextLevelButton" class="game-button btn-success">🚀 ¡Siguiente Nivel!</button>
        </div>
    </div>
    
    <!-- Modal de Pausa -->
    <div id="pauseModal" class="modal">
        <div class="modal-content">
            <h2>⏸️ Juego Pausado</h2>
            <p class="text-lg mb-6">El tiempo se ha detenido.</p>
            <div class="space-y-4">
                <button id="resumeButton" class="game-button btn-success">▶️ Reanudar</button>
                <button id="restartFromPause" class="game-button">🔄 Reiniciar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Estadísticas Finales -->
    <div id="finalStatsModal" class="modal">
        <div class="modal-content">
            <h2 id="finalStatsTitle"></h2>
            <div id="finalStatsContent" class="text-left space-y-3 mt-4"></div>
            <button id="restartGameButton" class="game-button btn-success mt-6">🚀 Jugar de Nuevo</button>
        </div>
    </div>

    <!-- 📜 SCRIPTS EN ORDEN CORRECTO -->
    <script>
        // Configuración de MathJax INLINE para evitar problemas
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            },
            startup: {
                ready: () => {
                    console.log('✅ MathJax configurado correctamente');
                    MathJax.startup.defaultReady();
                    if (window.mathRenderSystem) {
                        window.mathRenderSystem.initialize();
                    }
                }
            }
        };
    </script>
    <script src="questions.js"></script>
    <script src="curiosities.js"></script>
    <script src="game.js"></script>
</body>
</html>